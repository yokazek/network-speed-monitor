# NetSpeedChecker

[English Version (英語版)](README.en.md)

![NetSpeedChecker Dashboard](screenshot.png)

ネットワーク速度測定ツールです。一定間隔で速度を計測し、モダンな Web ダッシュボードで履歴を確認できます。
 
## 背景
Nuro光 に変更してからなんかWifi使っていると、つまりみたいなのがあり使うのにすごく時間がかかったり意図せずルーターが再起動しているようで、サポートに連絡してもらちが明かないので、定期的にネットワークに接続する。速度を測るツールを作ってみました。


## 特徴
- 🚀 **自動計測**: 指定した間隔（デフォルト20分）で自動的に速度を測定。
- 📊 **可視化**: Chart.js を使用したメインのライブグラフと、過去の推移を確認できる履歴グラフ。
- 📅 **履歴閲覧**: 1日単位で過去の速度測定データをカレンダーから選択して閲覧可能。
- 💎 **モダン UI**: 高級感のあるダークテーマとグラスモーフィズムデザイン。
- 🐍 **簡単セットアップ**: ラズパイ向けインストーラーを同梱。

## セットアップ (Raspberry Pi / Linux)

```bash
# クローンまたはコピー後、ディレクトリに移動
cd netspeedchecker

# 実行権限を付与
chmod +x install.sh run.sh

# インストール（初回のみ）
./install.sh

# 起動
./run.sh
```

## セットアップ (Windows)

```powershell
.\setup_windows.ps1
.\run_windows.ps1
```

起動後、ブラウザで `http://[ラズパイのIPアドレス]:8080` にアクセスしてください。

## 設定
`config.py` の定数を変更することで、測定間隔やサーバー設定を調整できます。

```python
# config.py
CHECK_INTERVAL = {"minutes": 30}  # 30分間隔にする場合
PORT = 8080                       # 使用するポート番号
```

## データ管理
長期間の運用を想定した設計になっています：
- **測定データ**: すべて `netchecker.db` (SQLite) に保存されます。データ量は軽量なため、数年分の蓄積でも数MB程度です。
- **システムログ**: 同じくデータベース内に保存されますが、**最新の1000件**のみを保持し、古いものは自動的に削除（ローテーション）されるため、ディスク容量を圧迫しません。
- **クリーンアップ**: ダッシュボードのボタンから、いつでも測定履歴やログを手動で全削除できます。

## ラズパイ運用のアドバイス (SDカード保護)
Raspberry PiのSDカードの摩耗を抑えるため、以下の最適化を標準で実施しています：
- **SQLiteの最適化**: WALモードの有効化と `synchronous=NORMAL` 設定により、物理的な書き込み回数を大幅に削減しています。
- **ログの自動制限**: データベース内のシステムログは最新1,000件のみを保持します。

さらに保護を強化したい場合は、**RAMディスク (tmpfs) の活用** をお勧めします：
1. `config.py` の `DB_PATH` を `/tmp/netchecker.db` などに変更する。
2. これにより全ての書き込みがメモリ上で行われるようになり、SDカードの寿命を最大限延ばせます（※再起動するとデータは消えます）。

## 技術スタック
- **Backend**: Python / FastAPI / APScheduler / SQLite
- **Frontend**: Vanilla JS / CSS / Chart.js

## ライセンス
[MIT License](LICENSE)
